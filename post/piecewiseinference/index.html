<!DOCTYPE html><html lang="en-us" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.5.0 for Hugo" />
  

  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Victor Boussange" />

  
  
  
    
  
  <meta name="description" content="This blog post discusses the use of PiecewiseInference.jl, a Julia package that enables the use of machine learning to fit complex ecological models on ecological dataset." />

  
  <link rel="alternate" hreflang="en-us" href="https://vboussange.github.io/post/piecewiseinference/" />

  
  
  
    <meta name="theme-color" content="#1565c0" />
  

  
  
    
    <script src="/js/mathjax-config.js"></script>
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha512-W0xM4mr6dEP9nREo7Z9z+9X70wytKvMGeDsj7ps2+xg5QPrEBXC8tAW1IFnzjR6eoJ90JmCnFzerQJTLzIEHjA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.e86434ae70bd28d2a9bb384cdaa99ea3.css" />

  



  


  


  




  
  
  

  

  
    <link rel="manifest" href="/manifest.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_hua3c898eed18b98379688891d5011a1d0_203625_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hua3c898eed18b98379688891d5011a1d0_203625_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="https://vboussange.github.io/post/piecewiseinference/" />

  
  
  
  
  
  
  
  
    
    
  
  

  
  
    
    
  
  <meta property="twitter:card" content="summary" />
  
    <meta property="twitter:site" content="@wowchemy" />
    <meta property="twitter:creator" content="@wowchemy" />
  
  <meta property="og:site_name" content="Victor Boussange" />
  <meta property="og:url" content="https://vboussange.github.io/post/piecewiseinference/" />
  <meta property="og:title" content="Inverse ecosystem modeling made easy with PiecewiseInference.jl | Victor Boussange" />
  <meta property="og:description" content="This blog post discusses the use of PiecewiseInference.jl, a Julia package that enables the use of machine learning to fit complex ecological models on ecological dataset." /><meta property="og:image" content="https://vboussange.github.io/media/icon_hua3c898eed18b98379688891d5011a1d0_203625_512x512_fill_lanczos_center_3.png" />
    <meta property="twitter:image" content="https://vboussange.github.io/media/icon_hua3c898eed18b98379688891d5011a1d0_203625_512x512_fill_lanczos_center_3.png" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2023-03-26T00:00:00&#43;00:00"
      />
    
    <meta property="article:modified_time" content="2023-03-26T00:00:00&#43;00:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://vboussange.github.io/post/piecewiseinference/"
  },
  "headline": "Inverse ecosystem modeling made easy with PiecewiseInference.jl",
  
  "datePublished": "2023-03-26T00:00:00Z",
  "dateModified": "2023-03-26T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Victor Boussange"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Victor Boussange",
    "logo": {
      "@type": "ImageObject",
      "url": "https://vboussange.github.io/media/icon_hua3c898eed18b98379688891d5011a1d0_203625_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "This blog post discusses the use of PiecewiseInference.jl, a Julia package that enables the use of machine learning to fit complex ecological models on ecological dataset."
}
</script>

  

  

  

  

<script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "all" } } }); </script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
tex2jax: {
inlineMath: [ ['$','$'], ["\\(","\\)"] ],
processEscapes: true
}
});
</script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

  <title>Inverse ecosystem modeling made easy with PiecewiseInference.jl | Victor Boussange</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="c4307fabcccfc98c6d6b74c8cf9f231b" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.e22a2a20712150175b9cd707be2d0584.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<header class="header--fixed">
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/">Victor Boussange</a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/">Victor Boussange</a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#about"><span>Home</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/studentprojects"><span>üî¨ Student projects</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#software"><span>üßëüèΩ‚Äçüíª Software</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#publications"><span>üìÑ Publications & Talks</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#teaching"><span>üéì Teaching & resources</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#posts"><span>üí¨ Posts</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
        

        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        
        <li class="nav-item dropdown theme-dropdown">
          <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
            <i class="fas fa-moon" aria-hidden="true"></i>
          </a>
          <div class="dropdown-menu">
            <a href="#" class="dropdown-item js-set-theme-light">
              <span>Light</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-dark">
              <span>Dark</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-auto">
              <span>Automatic</span>
            </a>
          </div>
        </li>
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Inverse ecosystem modeling made easy with PiecewiseInference.jl</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Mar 26, 2023
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    11 min read
  </span>
  

  
  
  
  

  
  

</div>

    





  
</div>



  <div class="article-container">

    <div class="article-style">
      <p>Mechanistic ecosystem models permit to quantiatively describe how population, species or communities grow, interact and evolve. Yet calibrating them to fit real-world data is a daunting task. That&rsquo;s why I&rsquo;m excited to introduce <a href="https://github.com/vboussange/PiecewiseInference.jl" target="_blank" rel="noopener"><strong>PiecewiseInference.jl</strong></a>, a new Julia package that provides a user-friendly and efficient framework for inverse ecosystem modeling. In this blog post, I will guide you through the main features of <strong>PiecewiseInference.jl</strong> and provide a step-by-step tutorial on how to use it with a three-compartment ecosystem model. Whether you&rsquo;re a quantitative ecologist or a curious data scientist, I hope this post will encourage you to join the effort and use and develop inverse ecosystem modelling methods to improve our understanding and predictions of ecosystems.</p>
<h2 id="preliminary-steps">Preliminary steps</h2>
<p>This tutorial relies on three packages that I have authored but are (yet) not registered on the official Julia registry. Those are</p>
<ul>
<li><code>PiecewiseInference</code>,</li>
<li><code>EcoEvoModelZoo</code>: a package which provides access to a collection of ecosystem models,</li>
<li><code>ParametricModels</code>: a wrapper package to manipulate dynamical models. Specifically, <code>ParametricModels</code> avoids the hassle of specifying, at each time you want to simulate an ODE model, boring details such as the algorithm to solve it, the time span, etc&hellip;</li>
</ul>
<p>To easily install them on your machine, you&rsquo;ll have to add my personal registry by doing the following:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="k">using</span> <span class="n">Pkg</span><span class="p">;</span> <span class="n">Pkg</span><span class="o">.</span><span class="n">Registry</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">RegistrySpec</span><span class="p">(</span><span class="n">url</span> <span class="o">=</span> <span class="s">&#34;https://github.com/vboussange/VBoussangeRegistry.git&#34;</span><span class="p">))</span>
</span></span></code></pre></div><p>Once this is done, let&rsquo;s import those together with other necessary Julia packages for this tutorial.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="k">using</span> <span class="n">Graphs</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">EcoEvoModelZoo</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ParametricModels</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">LinearAlgebra</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">UnPack</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">OrdinaryDiffEq</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">Statistics</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">SparseArrays</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ComponentArrays</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">PythonPlot</span>
</span></span></code></pre></div><p>We use <code>Graphs</code> to create a directed graph to represent the food web to be considered The <code>OrdinaryDiffEq</code> package provides tools for solving ordinary differential equations, while the <code>LinearAlgebra</code> package is used for linear algebraic computations. The <code>UnPack</code> package provides a convenient way to extract fields from structures, and the <code>ComponentArrays</code> package is used to store and manipulate the model parameters conveniently. Finally, the <code>PythonCall</code> package is used to interface with Python&rsquo;s Matplotlib library for visualization.</p>
<h2 id="definition-of-the-forward-model">Definition of the forward model</h2>
<h3 id="defining-hyperparameters-for-the-forward-simulation-of-the-model">Defining hyperparameters for the forward simulation of the model.</h3>
<p>Next, we define the algorithm used for solving the ODE model. We also define the
absolute tolerance (<code>abstol</code>) and relative tolerance (<code>reltol</code>) for the solver.
<code>tspan</code> is a tuple representing the time range we will simulate the system for,
and <code>tsteps</code> is a vector representing the times we want to output the simulated
data.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="n">alg</span> <span class="o">=</span> <span class="n">BS3</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">abstol</span> <span class="o">=</span> <span class="mf">1e-6</span>
</span></span><span class="line"><span class="cl"><span class="n">reltol</span> <span class="o">=</span> <span class="mf">1e-6</span>
</span></span><span class="line"><span class="cl"><span class="n">tspan</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">tsteps</span> <span class="o">=</span> <span class="n">range</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">tspan</span><span class="p">[</span><span class="k">end</span><span class="p">],</span> <span class="n">length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>300.0:3.0303030303030303:600.0
</code></pre><h3 id="defining-the-foodweb-structure">Defining the foodweb structure</h3>
<p>We&rsquo;ll define a 3-compartment ecosystem as presented in <a href="http://doi.wiley.com/10.2307/1939558" target="_blank" rel="noopener">McCann et al. (1994)</a>. We will use <code>SimpleEcosystemModel</code> from EcoEvoModeZoo.jl, which requires as input a foodweb structure. Let&rsquo;s use a <code>DiGraph</code> to represent it.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="n">N</span> <span class="o">=</span> <span class="mi">3</span> <span class="c"># number of compartment</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">foodweb</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">add_edge!</span><span class="p">(</span><span class="n">foodweb</span><span class="p">,</span> <span class="mi">2</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="c"># C to R</span>
</span></span><span class="line"><span class="cl"><span class="n">add_edge!</span><span class="p">(</span><span class="n">foodweb</span><span class="p">,</span> <span class="mi">3</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="c"># P to C</span>
</span></span></code></pre></div><pre tabindex="0"><code>true
</code></pre><p>The <code>N</code> variable specifies the number of
compartments in the model. The <code>add_edge!</code> function is used to add edges to the
graph, specifying the flow of resources between compartments.</p>
<p>For fun, let&rsquo;s just plot the foodweb. Here we use the PythonCall and PythonPlot
packages to visualize the food web as a directed graph using <code>networkx</code> and <code>numpy</code>.
We create a color list for the different species, and then create a directed
graph g_nx with networkx using the adjacency matrix of the food web. We also
specify the position of each node in the graph, and use nx.draw to draw the
graph with</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="k">using</span> <span class="n">PythonCall</span>
</span></span><span class="line"><span class="cl"><span class="n">nx</span> <span class="o">=</span> <span class="n">pyimport</span><span class="p">(</span><span class="s">&#34;networkx&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">np</span> <span class="o">=</span> <span class="n">pyimport</span><span class="p">(</span><span class="s">&#34;numpy&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">species_colors</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#34;tab:red&#34;</span><span class="p">,</span> <span class="s">&#34;tab:green&#34;</span><span class="p">,</span> <span class="s">&#34;tab:blue&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">g_nx</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">adjacency_matrix</span><span class="p">(</span><span class="n">foodweb</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl"><span class="n">pos</span> <span class="o">=</span> <span class="kt">Dict</span><span class="p">(</span><span class="mi">0</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">1</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">2</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">labs</span> <span class="o">=</span> <span class="kt">Dict</span><span class="p">(</span><span class="mi">0</span> <span class="o">=&gt;</span> <span class="s">&#34;Resource&#34;</span><span class="p">,</span> <span class="mi">1</span> <span class="o">=&gt;</span> <span class="s">&#34;Consumer&#34;</span><span class="p">,</span> <span class="mi">2</span> <span class="o">=&gt;</span> <span class="s">&#34;Prey&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">g_nx</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="n">species_colors</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">display</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</span></span></code></pre></div>













<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_6_1_hu62f1111d24c26835f7d3777e0accf1d1_18752_10e755f0e2d2b299c1ba09efc8ef5dcb.webp 400w,
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_6_1_hu62f1111d24c26835f7d3777e0accf1d1_18752_35f7999e8532103edebd24f910725eba.webp 760w,
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_6_1_hu62f1111d24c26835f7d3777e0accf1d1_18752_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_6_1_hu62f1111d24c26835f7d3777e0accf1d1_18752_10e755f0e2d2b299c1ba09efc8ef5dcb.webp"
               width="515"
               height="389"
               loading="lazy" data-zoomable /></div>
  </div></figure>
<h3 id="defining-the-ecosystem-model">Defining the ecosystem model</h3>
<p>Now that we have defined the foodweb structure, we can build the ecosystem
model, which will be a <code>SimpleEcosystemModel</code> from <code>EcoEvoModelZoo</code>.</p>
<p>The next several functions are required by <code>SimpleEcosystemModel</code> and define the
specific dynamics of the model. The <code>intinsic_growth_rate</code> function specifies
the intrinsic growth rate of each compartment, while the <code>carrying_capacity</code>
function specifies the carrying capacity of each compartment. The <code>competition</code>
function specifies the competition between and within compartments, while the
<code>resource_conversion_efficiency</code> function specifies the efficiency with which
resources are converted into consumer biomass. The <code>feeding</code> function specifies
the feeding interactions between compartments.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="n">intinsic_growth_rate</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">r</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="n">carrying_capacity</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@unpack</span> <span class="n">K‚ÇÅ‚ÇÅ</span> <span class="o">=</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl">    <span class="n">K</span> <span class="o">=</span> <span class="n">vcat</span><span class="p">(</span><span class="n">K‚ÇÅ‚ÇÅ</span><span class="p">,</span> <span class="n">ones</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">K</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="n">competition</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@unpack</span> <span class="n">A‚ÇÅ‚ÇÅ</span> <span class="o">=</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl">    <span class="n">A</span> <span class="o">=</span> <span class="n">spdiagm</span><span class="p">(</span><span class="n">vcat</span><span class="p">(</span><span class="n">A‚ÇÅ‚ÇÅ</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">A</span> <span class="o">*</span> <span class="n">u</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">resource_conversion_efficiency</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>resource_conversion_efficiency (generic function with 1 method)
</code></pre><p>To define the feeding processes, we use <code>adjacency_matrix</code> to get the adjacency matrix of the food web. We then use <code>findnz</code> from <code>SparseArrays</code> to get the row and column indices of the non-zero entries in the adjacency matrix, which we store in <code>I</code> and <code>J</code>. Those are then used to generate sparse matrices required for defining the functional responses of each species considered. The sparse matrices&rsquo; non-zero coefficients are the model parameters to be fitted.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="k">using</span> <span class="n">SparseArrays</span>
</span></span><span class="line"><span class="cl"><span class="n">W</span> <span class="o">=</span> <span class="n">adjacency_matrix</span><span class="p">(</span><span class="n">foodweb</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">I</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">findnz</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>([2, 3], [1, 2], [1, 1])
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="k">function</span> <span class="n">feeding</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@unpack</span> <span class="n">H‚ÇÇ‚ÇÅ</span><span class="p">,</span> <span class="n">H‚ÇÉ‚ÇÇ</span><span class="p">,</span> <span class="n">q‚ÇÇ‚ÇÅ</span><span class="p">,</span> <span class="n">q‚ÇÉ‚ÇÇ</span> <span class="o">=</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c"># handling time</span>
</span></span><span class="line"><span class="cl">    <span class="n">H</span> <span class="o">=</span> <span class="n">sparse</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">vcat</span><span class="p">(</span><span class="n">H‚ÇÇ‚ÇÅ</span><span class="p">,</span> <span class="n">H‚ÇÉ‚ÇÇ</span><span class="p">),</span> <span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c"># attack rates</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="o">=</span> <span class="n">sparse</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">vcat</span><span class="p">(</span><span class="n">q‚ÇÇ‚ÇÅ</span><span class="p">,</span> <span class="n">q‚ÇÉ‚ÇÇ</span><span class="p">),</span> <span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">q</span> <span class="o">.*</span> <span class="n">W</span> <span class="o">./</span> <span class="p">(</span><span class="n">one</span><span class="p">(</span><span class="n">eltype</span><span class="p">(</span><span class="n">u</span><span class="p">))</span> <span class="o">.+</span> <span class="n">q</span> <span class="o">.*</span> <span class="n">H</span> <span class="o">.*</span> <span class="p">(</span><span class="n">W</span> <span class="o">*</span> <span class="n">u</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span></code></pre></div><pre tabindex="0"><code>feeding (generic function with 1 method)
</code></pre><p>We are done defining the ecological processes.</p>
<h4 id="defining-the-ecosystem-model-parameters-for-generating-a-dataset">Defining the ecosystem model parameters for generating a dataset</h4>
<p>The parameters for the ecosystem model are defined using a <code>ComponentArray</code>. The
<code>u0_true</code> variable specifies the initial conditions for the simulation. The
<code>ModelParams</code> type from the ParametricModels package is used to specify the
model parameters and simulation settings. Finally, the <code>SimpleEcosystemModel</code>
type from the EcoEvoModelZoo package is used to define the ecosystem model.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="n">p_true</span> <span class="o">=</span> <span class="n">ComponentArray</span><span class="p">(</span><span class="n">H‚ÇÇ‚ÇÅ</span><span class="o">=</span><span class="p">[</span><span class="mf">1.24</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                        <span class="n">H‚ÇÉ‚ÇÇ</span><span class="o">=</span><span class="p">[</span><span class="mf">2.5</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                        <span class="n">q‚ÇÇ‚ÇÅ</span><span class="o">=</span><span class="p">[</span><span class="mf">4.98</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                        <span class="n">q‚ÇÉ‚ÇÇ</span><span class="o">=</span><span class="p">[</span><span class="mf">0.8</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                        <span class="n">r</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.08</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                        <span class="n">K‚ÇÅ‚ÇÅ</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                        <span class="n">A‚ÇÅ‚ÇÅ</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">u0_true</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.77</span><span class="p">,</span> <span class="mf">0.060</span><span class="p">,</span> <span class="mf">0.945</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mp</span> <span class="o">=</span> <span class="n">ModelParams</span><span class="p">(;</span> <span class="n">p</span><span class="o">=</span><span class="n">p_true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">tspan</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">u0</span><span class="o">=</span><span class="n">u0_true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">alg</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">reltol</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">abstol</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">saveat</span><span class="o">=</span><span class="n">tsteps</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">verbose</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span> <span class="c"># suppresses warnings for maxiters</span>
</span></span><span class="line"><span class="cl">    <span class="n">maxiters</span><span class="o">=</span><span class="mi">50_000</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">model</span> <span class="o">=</span> <span class="n">SimpleEcosystemModel</span><span class="p">(;</span> <span class="n">mp</span><span class="p">,</span> <span class="n">intinsic_growth_rate</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">carrying_capacity</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">competition</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">resource_conversion_efficiency</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">feeding</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>`Model` SimpleEcosystemModel
</code></pre><p>Let&rsquo;s run the model to generate a dataset! There is nothing more simple than that. Let&rsquo;s also plot it,
to get a sense of what it looks like.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">simulate</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">u0</span><span class="o">=</span><span class="n">u0_true</span><span class="p">)</span> <span class="o">|&gt;</span> <span class="kt">Array</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># plotting</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">PythonPlot</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="n">plot_time_series</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">subplots</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="o">:</span><span class="n">N</span>
</span></span><span class="line"><span class="cl">        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="o">:</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s">&#34;Species </span><span class="si">$i</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">species_colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">    <span class="c"># ax.set_yscale(&#34;log&#34;)</span>
</span></span><span class="line"><span class="cl">    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#34;Species abundance&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#34;Time (days)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">fig</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s">&#34;None&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">ax</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s">&#34;None&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">fig</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">display</span><span class="p">(</span><span class="n">plot_time_series</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</span></span></code></pre></div>













<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_11_1_hu88f93306fecaa2cf8298e559a40e861a_58481_c975a3cfc0846552c904f169348dcc29.webp 400w,
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_11_1_hu88f93306fecaa2cf8298e559a40e861a_58481_f877ee1ebc333b179217ec1015565366.webp 760w,
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_11_1_hu88f93306fecaa2cf8298e559a40e861a_58481_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_11_1_hu88f93306fecaa2cf8298e559a40e861a_58481_c975a3cfc0846552c904f169348dcc29.webp"
               width="624"
               height="483"
               loading="lazy" data-zoomable /></div>
  </div></figure>
<p>Let&rsquo;s add a bit of noise to the data to simulate experimental errors. We proceed by adding
log normally distributed noise, so that abundance are always positive (negative abundance would not make sense, but could happen when adding normally distributed noise!).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">.*</span> <span class="n">exp</span><span class="o">.</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">randn</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">display</span><span class="p">(</span><span class="n">plot_time_series</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</span></span></code></pre></div>













<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_12_1_hu50ffac68b212487f6faa1c84d11603c5_61363_cf84a27edd15202fdc0564e5f5ec4d61.webp 400w,
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_12_1_hu50ffac68b212487f6faa1c84d11603c5_61363_5247d0bf07af9c34f952b80f3e723489.webp 760w,
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_12_1_hu50ffac68b212487f6faa1c84d11603c5_61363_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_12_1_hu50ffac68b212487f6faa1c84d11603c5_61363_cf84a27edd15202fdc0564e5f5ec4d61.webp"
               width="624"
               height="483"
               loading="lazy" data-zoomable /></div>
  </div></figure>
<h2 id="inversion-with-piecewiseinferencejl">Inversion with <code>PiecewiseInference.jl</code></h2>
<p>Now that we have set up our model and generated some data, we can proceed with the inverse modelling using PiecewiseInference.jl.</p>
<p>PiecewiseInference.jl allows to perform inversion based on a segmentation method that partitions the data into short time series (segments), each treated independently and matched against simulations of the model considered. The segmentation approach helps to avoid the ill-behaved loss functions that arise from the strong nonlinearities of ecosystem models, when formulation the inference problem. Note that during the inversion, not only the parameters are inferred, but also the <strong>initial conditions</strong>, which are necessary to simulate the ODE model.</p>
<h3 id="definition-of-the-inferenceproblem">Definition of the <code>InferenceProblem</code></h3>
<p>We first import the packages required for the inversion. <code>PiecewiseInference</code> is the
main package used, but we also need <code>OptimizationFlux</code> for the <code>Adam</code> optimizer,
and <code>SciMLSensitivity</code> to define the sensitivity method used to differentiate
the forward model.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="k">using</span> <span class="n">PiecewiseInference</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">OptimizationFlux</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">SciMLSensitivity</span>
</span></span></code></pre></div><p>To initialize the inversion, we set the initial values for the parameters in <code>p_init</code> to those of <code>p_true</code> but modify the <code>H‚ÇÇ‚ÇÅ</code> parameter.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="n">p_init</span> <span class="o">=</span> <span class="n">p_true</span>
</span></span><span class="line"><span class="cl"><span class="n">p_init</span><span class="o">.</span><span class="n">H‚ÇÇ‚ÇÅ</span> <span class="o">.=</span> <span class="mf">2.0</span> <span class="c">#</span>
</span></span></code></pre></div><pre tabindex="0"><code>1-element view(::Vector{Float64}, 1:1) with eltype Float64:
 2.0
</code></pre><p>Next, we define a loss function <code>loss_likelihood</code> that compares the observed data
with the predicted data. Here, we use a simple mean-squared error loss function while log transforming the abundance, since the noise is log-normally distributed.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="n">loss_likelihood</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">rg</span><span class="p">)</span> <span class="o">=</span> <span class="n">sum</span><span class="p">((</span><span class="n">log</span><span class="o">.</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">.-</span> <span class="n">log</span><span class="o">.</span><span class="p">(</span><span class="n">pred</span><span class="p">))</span> <span class="o">.^</span> <span class="mi">2</span><span class="p">)</span><span class="c"># loss_fn_lognormal_distrib(data, pred, noise_distrib)</span>
</span></span></code></pre></div><pre tabindex="0"><code>loss_likelihood (generic function with 1 method)
</code></pre><p>We then define the <code>InferenceProblem</code>, which contains the forward
model, the initial parameter values, and the loss function.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="n">infprob</span> <span class="o">=</span> <span class="n">InferenceProblem</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">p_init</span><span class="p">;</span> <span class="n">loss_likelihood</span><span class="p">);</span>
</span></span></code></pre></div><p>It is also handy to use a callback function, that will be called after each iteration of the optimization routine, for visualizing the progress of the inference. Here, we use it to track the loss value and plot the data against the model predictions.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="n">info_per_its</span> <span class="o">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl"><span class="n">include</span><span class="p">(</span><span class="s">&#34;cb.jl&#34;</span><span class="p">)</span> <span class="c"># defines the `plotting_fit` function</span>
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="n">callback</span><span class="p">(</span><span class="n">p_trained</span><span class="p">,</span> <span class="n">losses</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">ranges</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">length</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span> <span class="o">%</span> <span class="n">info_per_its</span> <span class="o">==</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="n">plotting_fit</span><span class="p">(</span><span class="n">losses</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">ranges</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">tsteps</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span></code></pre></div><pre tabindex="0"><code>callback (generic function with 1 method)
</code></pre><h3 id="piecewise_mle-hyperparameters"><code>piecewise_MLE</code> hyperparameters</h3>
<p>To use <code>piecewise_MLE</code>, the main function of PiecewiseInference  to estimate the parameters that fit the observed data, we need to decide on two critical hyperparameters</p>
<ul>
<li><code>group_size</code>: the number of data points that define an interval, or segment. This number is usually small, but should be decided upon the dynamics of the model: to more nonlinear is the model, the lower <code>group_size</code> should be. We set it here to <code>11</code></li>
<li><code>batch_size</code>: the number of intervals, or segments, to consider on a single epoch. The higher the <code>batch_size</code>, the more computationally expensive a single iteration of <code>piecewise_MLE</code>, but the faster the convergence. Here, we set it to <code>5</code>, but could increase it to <code>10</code>, which is the total number of segments that we have.</li>
</ul>
<p>Another critical parameter to be decided upon is the automatic differentiation backend used to differentiate the ODE model. Two are supported, <code>Optimization.AutoForwardDiff()</code> and <code>Optimization.Autozygote()</code>. Simply put, <code>Optimization.AutoForwardDiff()</code> is used for forward mode sensitivity analysis, while <code>Optimization.Autozygote()</code> is used for backward mode sensitivity analysis. For more information on those, please refer to the documentation of <a href="https://docs.sciml.ai/Optimization/stable/" target="_blank" rel="noopener"><code>Optimization.jl</code></a>.</p>
<p>Other parameters required by <code>piecewise_MLE</code> are</p>
<ul>
<li>
<p><code>optimizers</code> specifies the optimization algorithm to be used for each batch. We use the <code>Adam</code> optimizer, which is the go-to optimizer to train deep learning models. It has a learning rate parameter that controls the step size at each iteration. We have chosen a value of <code>1e-2</code> because it provides good convergence without causing numerical instability,</p>
</li>
<li>
<p><code>epochs</code> specifies the number of epochs to be used for each batch. We chose a value of <code>500</code> because it is sufficient to achieve good convergence,</p>
</li>
<li>
<p><code>info_per_its</code> specifies after how many iterations the <code>callback</code> function should be called</p>
</li>
<li>
<p><code>verbose_loss</code> prints the value of the loss function during training,</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="nd">@time</span> <span class="n">res</span> <span class="o">=</span> <span class="n">piecewise_MLE</span><span class="p">(</span><span class="n">infprob</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                        <span class="n">adtype</span> <span class="o">=</span> <span class="n">Optimization</span><span class="o">.</span><span class="n">AutoZygote</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">                        <span class="n">group_size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">batchsizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">tsteps</span> <span class="o">=</span> <span class="n">tsteps</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">optimizers</span> <span class="o">=</span> <span class="p">[</span><span class="n">Adam</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">)],</span>
</span></span><span class="line"><span class="cl">                        <span class="n">epochs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">500</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                        <span class="n">verbose_loss</span> <span class="o">=</span> <span class="nb">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">info_per_its</span> <span class="o">=</span> <span class="n">info_per_its</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">multi_threading</span> <span class="o">=</span> <span class="nb">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">cb</span> <span class="o">=</span> <span class="n">callback</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>piecewise_MLE with 100 points and 10 groups.
Current loss after 50 iterations: 36.745952018526495
Current loss after 100 iterations: 15.064711239454626
Current loss after 150 iterations: 9.993029255013324
Current loss after 200 iterations: 7.994491307947515
Current loss after 250 iterations: 6.500818892986831
Current loss after 300 iterations: 5.3892647156988565
Current loss after 350 iterations: 3.0351181646280514
Current loss after 400 iterations: 2.674445730720996
Current loss after 450 iterations: 3.1591980829795676
Current loss after 500 iterations: 2.4343376293865995
157.765049 seconds (1.70 G allocations: 154.827 GiB, 10.16% gc time, 31.31%
 compilation time: 1% of which was recompilation)
`InferenceResult` with model SimpleEcosystemModel
</code></pre><p>













<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_1_hu644528a1afcd815ff2b86b36da8e875e_51903_052be7b24d15a8a1ec5bed0bda06abb3.webp 400w,
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_1_hu644528a1afcd815ff2b86b36da8e875e_51903_97dcb6d009d016383d30b3bb8171cd37.webp 760w,
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_1_hu644528a1afcd815ff2b86b36da8e875e_51903_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_1_hu644528a1afcd815ff2b86b36da8e875e_51903_052be7b24d15a8a1ec5bed0bda06abb3.webp"
               width="489"
               height="690"
               loading="lazy" data-zoomable /></div>
  </div></figure>













<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_2_hub59b77110153b2205abc9c1e99bfc5bf_57338_a0de2edb622a676911308bc7c027326f.webp 400w,
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_2_hub59b77110153b2205abc9c1e99bfc5bf_57338_37371b7de5af5259bdf23d2d6883bd20.webp 760w,
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_2_hub59b77110153b2205abc9c1e99bfc5bf_57338_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_2_hub59b77110153b2205abc9c1e99bfc5bf_57338_a0de2edb622a676911308bc7c027326f.webp"
               width="489"
               height="690"
               loading="lazy" data-zoomable /></div>
  </div></figure>













<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_3_hu0c6830235736031988016ed400339b9a_61477_1c204d0508f20610d84505b1e77cb3bc.webp 400w,
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_3_hu0c6830235736031988016ed400339b9a_61477_8c1118e95b11d7c7c26cd9db41ad4523.webp 760w,
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_3_hu0c6830235736031988016ed400339b9a_61477_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_3_hu0c6830235736031988016ed400339b9a_61477_1c204d0508f20610d84505b1e77cb3bc.webp"
               width="489"
               height="690"
               loading="lazy" data-zoomable /></div>
  </div></figure>













<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_4_huecf8cacf7a0f7f9060f2a1c560c36ba2_61371_70796bd92f69d9848045c8747c21e2eb.webp 400w,
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_4_huecf8cacf7a0f7f9060f2a1c560c36ba2_61371_e07ca3fe8b9e27e683d1e50c7808840d.webp 760w,
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_4_huecf8cacf7a0f7f9060f2a1c560c36ba2_61371_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_4_huecf8cacf7a0f7f9060f2a1c560c36ba2_61371_70796bd92f69d9848045c8747c21e2eb.webp"
               width="490"
               height="690"
               loading="lazy" data-zoomable /></div>
  </div></figure>













<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_5_huc0b13721a1fc34c0a8afcd483ca19fda_59693_c5f401e8b86a08001a2aebd584ba28af.webp 400w,
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_5_huc0b13721a1fc34c0a8afcd483ca19fda_59693_ab36b526814d592e4592f3302e97d665.webp 760w,
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_5_huc0b13721a1fc34c0a8afcd483ca19fda_59693_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_5_huc0b13721a1fc34c0a8afcd483ca19fda_59693_c5f401e8b86a08001a2aebd584ba28af.webp"
               width="489"
               height="690"
               loading="lazy" data-zoomable /></div>
  </div></figure>













<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_6_hu8b153de27522278f60c8b9094dba7d26_58645_4bbecbdf3fa63ce1fede227fce3b8977.webp 400w,
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_6_hu8b153de27522278f60c8b9094dba7d26_58645_752c57695f0f5cd04e3cb3a70cb0ce21.webp 760w,
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_6_hu8b153de27522278f60c8b9094dba7d26_58645_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_6_hu8b153de27522278f60c8b9094dba7d26_58645_4bbecbdf3fa63ce1fede227fce3b8977.webp"
               width="489"
               height="690"
               loading="lazy" data-zoomable /></div>
  </div></figure>













<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_7_hub43b68847da7711a5b38542b22e53e3a_56399_10a11afb84b89ce0e9ed83394b7b9e3b.webp 400w,
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_7_hub43b68847da7711a5b38542b22e53e3a_56399_2df980826d955efac7e5de19466655fa.webp 760w,
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_7_hub43b68847da7711a5b38542b22e53e3a_56399_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_7_hub43b68847da7711a5b38542b22e53e3a_56399_10a11afb84b89ce0e9ed83394b7b9e3b.webp"
               width="489"
               height="690"
               loading="lazy" data-zoomable /></div>
  </div></figure>













<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_8_hud367ed67f9cef0b1b3e29612594ffe3d_53849_4bff0413d5c6e5b1cb6196a8c43e2c56.webp 400w,
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_8_hud367ed67f9cef0b1b3e29612594ffe3d_53849_f9133b73685625059329d3525a171463.webp 760w,
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_8_hud367ed67f9cef0b1b3e29612594ffe3d_53849_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_8_hud367ed67f9cef0b1b3e29612594ffe3d_53849_4bff0413d5c6e5b1cb6196a8c43e2c56.webp"
               width="489"
               height="690"
               loading="lazy" data-zoomable /></div>
  </div></figure>













<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_9_hu9ea766d9bd81b237a28e713a1d702d64_54361_ad72f6d0ff86bfbeb34abb63253fe332.webp 400w,
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_9_hu9ea766d9bd81b237a28e713a1d702d64_54361_c7efedd5ddf92a4004a51498d2c68267.webp 760w,
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_9_hu9ea766d9bd81b237a28e713a1d702d64_54361_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_9_hu9ea766d9bd81b237a28e713a1d702d64_54361_ad72f6d0ff86bfbeb34abb63253fe332.webp"
               width="489"
               height="690"
               loading="lazy" data-zoomable /></div>
  </div></figure>













<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_10_hu31111221a9b8d5443a38403556a4aa3b_53967_90f96d7145da90f6a70a84d076c4e54d.webp 400w,
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_10_hu31111221a9b8d5443a38403556a4aa3b_53967_df825400af3210504bd5ee8772bcb331.webp 760w,
               /post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_10_hu31111221a9b8d5443a38403556a4aa3b_53967_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/piecewiseinference/figures/PiecewiseInference_tuto_3sp_18_10_hu31111221a9b8d5443a38403556a4aa3b_53967_90f96d7145da90f6a70a84d076c4e54d.webp"
               width="489"
               height="690"
               loading="lazy" data-zoomable /></div>
  </div></figure></p>
<p>Finally, we can examine the results of the inversion. We can look at the final parameters, and the initial conditions inferred for each segement:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="c"># Some more code</span>
</span></span><span class="line"><span class="cl"><span class="n">p_trained</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">p_trained</span>
</span></span><span class="line"><span class="cl"><span class="n">u0s_trained</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">u0s_trained</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="n">print_param_values</span><span class="p">(</span><span class="n">p_trained</span><span class="p">,</span> <span class="n">p_true</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">k</span> <span class="k">in</span> <span class="n">keys</span><span class="p">(</span><span class="n">p_trained</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">println</span><span class="p">(</span><span class="n">string</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">println</span><span class="p">(</span><span class="s">&#34;trained value = &#34;</span><span class="p">);</span> <span class="n">display</span><span class="p">(</span><span class="n">p_trained</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">println</span><span class="p">(</span><span class="s">&#34;true value =&#34;</span><span class="p">);</span> <span class="n">display</span><span class="p">(</span><span class="n">p_true</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">print_param_values</span><span class="p">(</span><span class="n">p_trained</span><span class="p">,</span> <span class="n">p_true</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>H‚ÇÇ‚ÇÅ
trained value = 
1-element Vector{Float64}:
 1.4786844814887716
true value =
1-element Vector{Float64}:
 2.0
H‚ÇÉ‚ÇÇ
trained value = 
1-element Vector{Float64}:
 1.891238277791975
true value =
1-element Vector{Float64}:
 2.5
q‚ÇÇ‚ÇÅ
trained value = 
1-element Vector{Float64}:
 4.550896291686214
true value =
1-element Vector{Float64}:
 4.98
q‚ÇÉ‚ÇÇ
trained value = 
1-element Vector{Float64}:
 0.7250599871665505
true value =
1-element Vector{Float64}:
 0.8
r
trained value = 
3-element Vector{Float64}:
  0.8705446490535288
 -0.30124597815843823
 -0.08241879418666838
true value =
3-element Vector{Float64}:
  1.0
 -0.4
 -0.08
K‚ÇÅ‚ÇÅ
trained value = 
1-element Vector{Float64}:
 1.0397189294700315
true value =
1-element Vector{Float64}:
 1.0
A‚ÇÅ‚ÇÅ
trained value = 
1-element Vector{Float64}:
 0.972947353012839
true value =
1-element Vector{Float64}:
 1.0
</code></pre><h3 id="your-turn-to-play">Your turn to play!</h3>
<p>You can try to change e.g. the <code>batch_sizes</code> and the <code>group_size</code>. How do those parameters influence the quality of the inversion?</p>
<h2 id="conclusion">Conclusion</h2>
<p>PiecewiseInference.jl provides an efficient and flexible way to perform inference on complex ecological models, making use of automatic differentiation and optimizers traditionally used in Machine Learning. The segmentation method implemented in PiecewiseInference.jl regularizes the inference problem and enables inverse modelling of complex dynamical systems, for which standard methods would otherwise fail.</p>
<p>Furthermore, PiecewiseInference.jl together with EcoEvoModelZoo.jl offer a powerful toolkit for ecologists and evolutionary biologists to benchmark and validate models against data. The combination of theoretical modelling and data can provide new insights into complex ecological systems, helping us to better understand and predict the dynamics of biodiversity.</p>
<p>We invite users to explore these packages and contribute to their development, by adding new models to the EcoEvoModelZoo.jl and improve the features of PiecewiseInference.jl. With these tools, we can continue to push the boundaries of ecological modelling and make important strides towards a more sustainable future.</p>
<h2 id="appendix">Appendix</h2>
<p>You can find the corresponding tutorial as a <code>.jmd</code> file at <a href="https://github.com/vboussange/MyTutorials" target="_blank" rel="noopener">https://github.com/vboussange/MyTutorials</a>.
Please contact me, if you have found a mistake, or if you have any comment or suggestion on how to improve this tutorial.</p>

    </div>

    




<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/scientific-machine-learning/">Scientific Machine Learning</a>
  
  <a class="badge badge-light" href="/tag/julia/">julia</a>
  
</div>



<div class="share-box">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://vboussange.github.io/post/piecewiseinference/&amp;text=Inverse%20ecosystem%20modeling%20made%20easy%20with%20PiecewiseInference.jl" target="_blank" rel="noopener" class="share-btn-twitter" aria-label="twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://vboussange.github.io/post/piecewiseinference/&amp;t=Inverse%20ecosystem%20modeling%20made%20easy%20with%20PiecewiseInference.jl" target="_blank" rel="noopener" class="share-btn-facebook" aria-label="facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Inverse%20ecosystem%20modeling%20made%20easy%20with%20PiecewiseInference.jl&amp;body=https://vboussange.github.io/post/piecewiseinference/" target="_blank" rel="noopener" class="share-btn-email" aria-label="envelope">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://vboussange.github.io/post/piecewiseinference/&amp;title=Inverse%20ecosystem%20modeling%20made%20easy%20with%20PiecewiseInference.jl" target="_blank" rel="noopener" class="share-btn-linkedin" aria-label="linkedin-in">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=Inverse%20ecosystem%20modeling%20made%20easy%20with%20PiecewiseInference.jl%20https://vboussange.github.io/post/piecewiseinference/" target="_blank" rel="noopener" class="share-btn-whatsapp" aria-label="whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://vboussange.github.io/post/piecewiseinference/&amp;title=Inverse%20ecosystem%20modeling%20made%20easy%20with%20PiecewiseInference.jl" target="_blank" rel="noopener" class="share-btn-weibo" aria-label="weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="https://vboussange.github.io"><img class="avatar mr-3 avatar-circle" src="/authors/admin/avatar_hu17fe142d2d9ea2daa3913aa53535eec6_854723_270x270_fill_q75_lanczos_center.jpg" alt="Victor Boussange"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://vboussange.github.io">Victor Boussange</a></h5>
      <h6 class="card-subtitle">Postdoctoral researcher</h6>
      <p class="card-text">Scientific machine learning and computational ecology.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
    <li>
      <a href="mailto:vic.boussange@gmail.com" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.com/citations?user=SaQH5YoAAAAJ&amp;hl=en" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/vboussange" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="/uploads/cv.pdf" >
        <i class="ai ai-cv"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://orcid.org/0000-0002-4202-3599" target="_blank" rel="noopener">
        <i class="ai ai-orcid"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>


















  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  



  

  

  

  
  






  
  
  

  
  
    
  
  
    
  

  

  
  <p class="powered-by copyright-license-text">
    ¬© 2026 Me. This work is licensed under <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank">CC BY NC ND 4.0</a>
  </p>
  

  <p class="powered-by footer-license-icons">
    <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank" aria-label="Creative Commons">
      <i class="fab fa-creative-commons fa-2x" aria-hidden="true"></i>
      <i class="fab fa-creative-commons-by fa-2x" aria-hidden="true"></i>
      
        <i class="fab fa-creative-commons-nc fa-2x" aria-hidden="true"></i>
      
      
        <i class="fab fa-creative-commons-nd fa-2x" aria-hidden="true"></i>
      
    </a>
  </p>




  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a> ‚Äî the free, <a href="https://github.com/wowchemy/wowchemy-hugo-themes" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

      

    
    <script src="/js/vendor-bundle.min.3d946de2e8784a477845261d87025092.js"></script>

    
    
    
      

      
      

      

      
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/highlight.min.js" integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin="anonymous"></script>
        
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/languages/r.min.js" crossorigin="anonymous"></script>
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/languages/latex.min.js" crossorigin="anonymous"></script>
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/languages/julia.min.js" crossorigin="anonymous"></script>
        
      

    

    
    
    

    
    

    
    
    
      
      <script id="search-hit-fuse-template" type="text/x-template">
        <div class="search-hit" id="summary-{{key}}">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{title}}</a>
              <div class="article-metadata search-hit-type">{{type}}</div>
              <p class="search-hit-description">{{snippet}}</p>
            </div>
          </div>
        </div>
      </script>
      
        <script src="https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
      
    

    
    

    
    
    
    

    
    
      
      
      
      
      
      
      
    

    

    
    
    
    <script id="page-data" type="application/json">{"use_headroom":true}</script>

    
    
      <script src="/js/wowchemy-headroom.e8fd2d733eef6a8bbbe0539398fc0547.js" type="module"></script>
    
    
    
    
    
    
    
      
      
    
    
    <script src="/en/js/wowchemy.min.de33c90527762392d440555c36739dd9.js"></script>

    
    
    
    
    
    
      
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      <script src="/js/wowchemy-publication.b0d291ed6d27eacec233e6cf5204f99a.js" type="module"></script>






</body>
</html>
